var offsetxpoint=-60 //Customize x offset of tooltip
var offsetypoint=20 //Customize y offset of tooltip
var ie=document.all
var ns6=document.getElementById && !document.all
var enabletip=false
if (ie||ns6)
var tipobj=document.all? document.getElementById("dhtmltooltip") : document.getElementById? document.getElementById("dhtmltooltip") : ""

function ietruebody(){
return (document.compatMode && document.compatMode!="BackCompat")? document.documentElement : document.body
}

function ddrivetip(thetext, thecolor, thewidth){
if (ns6||ie){
if (typeof thewidth!="undefined") tipobj.style.width=thewidth+"px"
if (typeof thecolor!="undefined" && thecolor!="") tipobj.style.backgroundColor=thecolor
tipobj.innerHTML=thetext
enabletip=true
return false
}
}

function positiontip(e){
if (enabletip){
var curX=(ns6)?e.pageX : event.x+ietruebody().scrollLeft;
var curY=(ns6)?e.pageY : event.y+ietruebody().scrollTop;
//Find out how close the mouse is to the corner of the window
var rightedge=ie&&!window.opera? ietruebody().clientWidth-event.clientX-offsetxpoint : window.innerWidth-e.clientX-offsetxpoint-20
var bottomedge=ie&&!window.opera? ietruebody().clientHeight-event.clientY-offsetypoint : window.innerHeight-e.clientY-offsetypoint-20

var leftedge=(offsetxpoint<0)? offsetxpoint*(-1) : -1000

//if the horizontal distance isn't enough to accomodate the width of the context menu
if (rightedge<tipobj.offsetWidth)
//move the horizontal position of the menu to the left by it's width
tipobj.style.left=ie? ietruebody().scrollLeft+event.clientX-tipobj.offsetWidth+"px" : window.pageXOffset+e.clientX-tipobj.offsetWidth+"px"
else if (curX<leftedge)
tipobj.style.left="5px"
else
//position the horizontal position of the menu where the mouse is positioned
tipobj.style.left=curX+offsetxpoint+"px"

//same concept with the vertical position
if (bottomedge<tipobj.offsetHeight)
tipobj.style.top=ie? ietruebody().scrollTop+event.clientY-tipobj.offsetHeight-offsetypoint+"px" : window.pageYOffset+e.clientY-tipobj.offsetHeight-offsetypoint+"px"
else
tipobj.style.top=curY+offsetypoint+"px"
tipobj.style.visibility="visible"
}
}

function hideddrivetip(){
if (ns6||ie){
enabletip=false
tipobj.style.visibility="hidden"
tipobj.style.left="-1000px"
tipobj.style.backgroundColor=''
tipobj.style.width=''
}
}
document.onmousemove=positiontip



var prev_divid		= "";
var prev_formCount	= "";
var prev_mode		= "";


function GoWrite( divid, mode, name, title, content, Count, Msg )
{

	chk	= mode +"_"+ Count;
	if ( prev_divid != "" && prev_mode != chk )
	{
		document.getElementById(prev_divid).style.display = "none";
		var prev_frm = document.forms["reply_frm_"+prev_formCount];
		prev_frm.mode.value		= "";
		prev_frm.name.value		= "";
		prev_frm.content.value	= "";
	}
	prev_divid			= divid;
	prev_formCount		= Count;
	prev_mode			= mode +"_"+ Count;



	var chk = document.getElementById(divid).style.display;
	chk = ( chk == '' )?'none':'';
	document.getElementById(divid).style.display = chk;

	var frm =document.forms["reply_frm_"+Count];
	frm.mode.value		= mode;
	frm.name.value		= name;
	frm.content.value	= content;

	field_space_check2("reply_frm_"+prev_formCount, 'name','','','black');
	field_space_check2("reply_frm_"+prev_formCount, 'content','','','black');
	//frm.sendit.value	= Msg;


}

var prev_replyDiv	= "";
function ShowReply( replyDiv )
{
	if ( prev_replyDiv != replyDiv && prev_replyDiv != "" )
	{
		document.getElementById(prev_replyDiv).style.display = "none";
	}
	prev_replyDiv	= replyDiv;

	var chk	= document.getElementById(replyDiv).style.display;
	chk = ( chk == '' )?'none':'';
	document.getElementById(replyDiv).style.display = chk;
}

function ReplyDelete(number)
{
	if ( confirm("정말 삭제하시겠습니까?" ) )
	{
		alert("알겟다");
	}
}


function field_space_check( objId , fieldCheck , outText , outColor)
{
	var obj  = document.getElementById(objId);

	objValue = obj.value;

	if ( objValue == fieldCheck )
	{
		obj.value  = outText;
		obj.style.color = outColor;
	}
}


function field_space_check2( form, objId , fieldCheck , outText , outColor)
{
	var obj  = eval( 'document.'+ form +'.'+ objId );

	objValue = obj.value;


	if ( objValue == fieldCheck )
	{
		obj.value  = outText;
		if(obj.style != null)
		{
			obj.style.color = outColor;
		}
	}
}


function view_box(val) {
	box_reple = eval(val);
	if (box_reple.style.display == 'none') box_reple.style.display = '';
	else box_reple.style.display = 'none';
}







//####################옵션주문관련 스크립트####################
//가상장바구니 관련 스크립트
var vertual_cart_no = 0;
//주상품옵션체크 배열
var vertual_cart_opt = new Array();
var vertual_cart_text = new Array();
//var view_vcart_price_total = 0;


//주문시옵션 키
var gubun_options = new Array();

//추가상품 키
var etc_options = new Array();


function vertual_cart()
{
	form = document.regiform;
	
	select_array = new Array();
	
	
	//선택사항
	if ( regiform.search_category1 )
	{
		select_array.push(regiform.search_category1);
	}
	if ( regiform.search_category2 )
	{
		select_array.push(regiform.search_category2);
	}
	//추가상품 다중선택
	if ( regiform.etc_option && regiform.etc_option.selectedIndex != 0 )
	{
		//select_array.push(regiform.etc_option);
	}
	//사은품
	if ( regiform.bonus_option && regiform.bonus_option.selectedIndex != 0  )
	//if ( regiform.bonus_option )
	{
		//select_array.push(regiform.bonus_option);
	}

	select_cnt = select_array.length;

	select_texts = new Array();
	select_values = new Array();

	for ( i = 0;i<select_cnt ;i++ )
	{
		select_value = "";
		select_text = "";

		if ( select_array[i] )
		{
			select_name = select_array[i].name;
			select_value = select_array[i].options[select_array[i].selectedIndex].value;
			select_text = select_array[i].options[select_array[i].selectedIndex].text;

			if ( select_value != "" )
			{
				select_values.push(select_name+"___cut___"+select_value);
				select_texts.push(select_text);
			}
		}
	}

	if ( select_values.length % select_cnt == 0 )
	{
		vertual_cart_add(select_values,select_texts,select_cnt);
	}
}

//추가상품 다중선택
function vertual_cart_etc()
{
	form = document.regiform;
	
	select_array = new Array();

	//추가상품 다중선택
	if ( regiform.etc_option && regiform.etc_option.selectedIndex != 0 )
	{
		select_array.push(regiform.etc_option);
	}

	select_cnt = select_array.length;

	select_texts = new Array();
	select_values = new Array();

	for ( i = 0;i<select_cnt ;i++ )
	{
		select_value = "";
		select_text = "";

		if ( select_array[i] )
		{
			select_name = select_array[i].name;
			select_value = select_array[i].options[select_array[i].selectedIndex].value;
			select_text = select_array[i].options[select_array[i].selectedIndex].text;

			if ( select_value != "" )
			{
				select_values.push(select_name+"___cut___"+select_value);
				select_texts.push(select_text);
			}
		}
	}


	if ( select_values.length % select_cnt == 0 )
	{
		//alert(select_cnt);
		vertual_cart_add_etc(select_values,select_texts,select_cnt);
	}

}

//추가상품 다중선택
function vertual_cart_add_etc(sel_values,sel_titles,sel_cnt)
{
	//alert(sel_values);
	//alert(sel_titles);
	//alert(sel_values[0]);
	//alert(sel_values[1]);
	//alert(sel_values[2]);
	
	//tmp_values = sel_values.join("___cut___");
	//tmp_titles = sel_titles.join("___cut___");

	tmp_values = new Array();
	c_html = new Array();

	vcart_id = "tmp_vcart_etc"+vertual_cart_no;
	
	if ( sel_values == "" )
	{
		return;
	}

	c_html.push('<div id="'+vcart_id+'">');
	//c_html.push('<table width="100%" border="0" cellpadding="0" cellspacing="1" bgcolor="#DADADA"><tr><td style="padding:10;" bgcolor="#FFFFFF">');
	//주문내역 전채를 감싸는 테이블이 필요합니다.

	c_html.push('<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr style="padding-bottom:3;">');
	c_html.push('<td class="smfont">');

	total_price = 0;
	tmp_title_total = "";

	for ( i=0;i<sel_cnt ;i++ )
	{
		tmp_values[i] = sel_values[i].split("___cut___");
		tmp_title = "";
		tmp_price = "";
		one_price = 0;

		sel_titles_name = "";
		if ( tmp_values[i][0] == "etc_option" )
		{
			sel_titles_name = "<b>";
		}

		tmp_title = separate_title(sel_titles[i],'title');
		tmp_price = separate_title(sel_titles[i],'price');
		
		if ( tmp_price != undefined )
		{
			one_price = tmp_price;
			//alert(tmp_price+":"+one_price);
			total_price = 0 + total_price + parseFloat(one_price);
			total_price = total_price * 100 / 100;
			total_price_comma = number_format(total_price);
		}
		

		c_html.push('<input size="4" type="hidden" id="'+tmp_values[i][0]+'['+vertual_cart_no+']" name="'+tmp_values[i][0]+'['+vertual_cart_no+']" value="'+tmp_values[i][1]+'">');		//옵션value
		c_html.push('<input size="4" type="hidden" id="'+tmp_values[i][0]+'_price['+vertual_cart_no+']" name="'+tmp_values[i][0]+'_price['+vertual_cart_no+']" value="'+one_price+'">');			//개별추가금액
		
		//구분1, 구분2
		c_html.push(sel_titles_name);
		c_html.push("");
		c_html.push(tmp_title);

		tmp_title_total += tmp_values[i][1];


		
	}

	//이미 들어가 있는건지 체크
	cart_cnt = vertual_cart_text.length;
	if ( cart_cnt != 0 )
	{
		for ( already in vertual_cart_text )
		{
			//alert(tmp_title_total);
			if ( vertual_cart_text[already] == tmp_title_total )
			{
				//alert("이미있다");
				return;
			}
		}
	}

	c_html.push('</td>');
	c_html.push('<td width="85" style="padding:10px 0 10px 0;">');
	c_html.push('<table cellspacing="0">');
	c_html.push('<tr><td><a href="javascript:void(0);" onclick="quantity_minus(\''+vertual_cart_no+'\');vertual_cart_quantity(\''+vertual_cart_no+'\');"><img src="img/btn_cart_minus.gif" border="0" align="absmiddle" alt="-"></a></td> ');
	c_html.push('<td style="padding:0 4px 0 4px;"><input type="text" id="etc_want_quantity['+vertual_cart_no+']" name="etc_want_quantity['+vertual_cart_no+']" value="1" class="inputstyle" style="width:26px;height:14px; text-align:center;" onchange="vertual_cart_quantity(\''+vertual_cart_no+'\');"></td>');
	c_html.push('<td><a href="javascript:void(0);" onclick="quantity_plus(\''+vertual_cart_no+'\');vertual_cart_quantity(\''+vertual_cart_no+'\');"><img src="img/btn_cart_plus.gif" border="0" align="absmiddle" alt="+"></a></td><td style="padding-left:2px;">개</td></tr>');
	c_html.push('</table>');
	c_html.push('</td>');
	c_html.push('<td align="right" style="padding-right:5;" width="120">');
	c_html.push('<input type="hidden" id="etc_price_'+vertual_cart_no+'" name="etc_price_'+vertual_cart_no+'" value="'+total_price+'">');
	c_html.push('<input type="hidden" id="etc_price2['+vertual_cart_no+']" name="etc_price2['+vertual_cart_no+']" value="'+total_price+'">');
	c_html.push('<b><span id="view_vcart_price_'+vertual_cart_no+'">'+total_price_comma+' 원</span></b>');
	c_html.push('</td>');


	c_html.push('<td width="20" align="left"><a href="javascript:void(0);" onclick="vertual_cart_del(\''+vcart_id+'\',\''+vertual_cart_no+'\');"><img src="img/btn_cart_del.gif" border="0" align="absmiddle" alt="삭제"></a></td>');

	c_html.push('<td width="5">&nbsp;</td>');
	c_html.push('</tr>');

	c_html.push('<tr><td style="background-color:#ddd; height:1px;" colspan="5"></td></tr>');

	c_html.push('</table>');
	//c_html.push('</td></tr></table>');
	//주문내역 전채를 감싸는 테이블이 필요합니다.
	c_html.push('</div>');

	//alert(c_html);

	//document.getElementById('debug').value = c_html.join("");
	
	if ( sel_values != "" )
	{
		//추가상품 키를 저장
		etc_options.push(vertual_cart_no);

		vertual_cart_text[vertual_cart_no] = tmp_title_total;
		document.getElementById('vertual_cart_etc').innerHTML += '' + c_html.join("");
	
		//alert(c_html.join(""));
		vertual_cart_no++;



		document.getElementById('vertual_cart_table').style.display = '';
		
		//옵션합계금액
		total_price2 = option_price_total();

		//추가상품금액
		etc_price2 = etc_price_total();

		//document.getElementById('view_vcart_price_total').innerHTML = number_format(total_price2+etc_price2);


		//상품금액 추가됨
		cnt = document.regiform.length;
		quantity_total = 0;
		etc_price = 0;

		for ( i=0;i<cnt ;i++ )
		{
			if ( document.regiform[i].name.match("^want_quantity") )
			{
				quantity_total = quantity_total + parseFloat(document.regiform[i].value);
			}
		}

		//product_price = document.regiform.baro_price.value * quantity_total;
		//document.getElementById('view_vcart_product_price_total').innerHTML = number_format(product_price);

		//총결제금액
		//document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(product_price+total_price2+etc_price2);
		document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(total_price2+etc_price2);
		//합계금액

		
		//초기화
		//regiform_0();
		/*
		if ( select_array[2] )
		{
			select_array[2].selectedIndex = 0;
		}
		if ( select_array[3] )
		{
			select_array[3].selectedIndex = 0;
		}
		*/
		//초기화
	}

}


//가상장바구니에 담기
function vertual_cart_add(sel_values,sel_titles,sel_cnt)
{
	//alert(sel_values);
	//alert(sel_titles);
	//alert(sel_values[0]);
	//alert(sel_values[1]);
	//alert(sel_values[2]);
	
	//tmp_values = sel_values.join("___cut___");
	//tmp_titles = sel_titles.join("___cut___");

	tmp_values = new Array();
	c_html = new Array();

	vcart_id = "tmp_vcart_"+vertual_cart_no;
	
	if ( sel_values == "" )
	{
		return;
	}
	
	c_html.push('<div id="'+vcart_id+'">');
	//c_html.push('<table width="100%" border="0" cellpadding="0" cellspacing="1" bgcolor="#DADADA"><tr><td style="padding:10;" bgcolor="#FFFFFF">');
	//주문내역 전채를 감싸는 테이블이 필요합니다.

	c_html.push('<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr style="padding-bottom:3;">');
	c_html.push('<td class="smfont" >');

	total_price = 0;
	tmp_title_total = "";

	for ( i=0;i<sel_cnt ;i++ )
	{
		tmp_values[i] = sel_values[i].split("___cut___");
		tmp_title = "";
		tmp_price = "";
		one_price = 0;

		sel_titles_name = "";
		if ( tmp_values[i][0] == "search_category1" )
		{
			sel_titles_name = "<b>";
		}
		else if ( tmp_values[i][0] == "search_category2" )
		{
			sel_titles_name = "&nbsp;";
		}
		//else if ( tmp_values[i][0] == "etc_option" )
		//{
		//	sel_titles_name = "</b><br>추가상품 : &nbsp;";
		//}
		else if ( tmp_values[i][0] == "bonus_option" )
		{
			sel_titles_name = "<br>사은품 : &nbsp;";
		}

		tmp_title = separate_title(sel_titles[i],'title');
		tmp_price = separate_title(sel_titles[i],'price');
		
		if ( tmp_price != undefined )
		{
			one_price = tmp_price;
			//alert(tmp_price+":"+one_price);
			total_price = 0 + total_price + parseFloat(one_price);
			total_price = total_price * 100 / 100;
			total_price_comma = number_format(total_price);
		}
		

		c_html.push('<input size="4" type="hidden" id="'+tmp_values[i][0]+'['+vertual_cart_no+']" name="'+tmp_values[i][0]+'['+vertual_cart_no+']" value="'+tmp_values[i][1]+'">');		//옵션value
		c_html.push('<input size="4" type="hidden" id="'+tmp_values[i][0]+'_price['+vertual_cart_no+']" name="'+tmp_values[i][0]+'_price['+vertual_cart_no+']" value="'+one_price+'">');			//개별추가금액
		
		//구분1, 구분2
		c_html.push(sel_titles_name);

		//옵션이 하나 밖에 없을때는
		if ( is_danil != 1 )
		{
			c_html.push("");
			c_html.push(tmp_title);
		}
		else if ( i == 0 )
		{
			c_html.push("주문수량");
		}
		//옵션이 하나 밖에 없을때는


		tmp_title_total += tmp_values[i][1];
	}

	//이미 들어가 있는건지 체크
	cart_cnt = vertual_cart_text.length;
	if ( cart_cnt != 0 )
	{
		for ( already in vertual_cart_text )
		{
			//alert(tmp_title_total);
			if ( vertual_cart_text[already] == tmp_title_total )
			{
				//alert("이미있다");
				return;
			}
		}
	}

	c_html.push('</td>');
	c_html.push('<td width="85" style="padding:9px 0 9px 0;">');
	c_html.push('<table cellspacing="0">');
	c_html.push('<tr><td><a href="javascript:void(0);" onclick="quantity_minus(\''+vertual_cart_no+'\');vertual_cart_quantity(\''+vertual_cart_no+'\');"><img src="img/btn_cart_minus.gif" border="0" align="absmiddle" alt="-"></a> </td>');
	c_html.push('<td style="padding:0 4px 0 4px;"><input type="text" id="want_quantity['+vertual_cart_no+']" name="want_quantity['+vertual_cart_no+']" value="1" class="inputstyle" style="width:26px;height:15px;text-align:center" onchange="vertual_cart_quantity(\''+vertual_cart_no+'\');"></td>');
	c_html.push('<td><a href="javascript:void(0);" onclick="quantity_plus(\''+vertual_cart_no+'\');vertual_cart_quantity(\''+vertual_cart_no+'\');"><img src="img/btn_cart_plus.gif" border="0" align="absmiddle" alt="+"></a></td><td style="padding-left:3px;">개</td></tr>');
	c_html.push('</table></td>');
	c_html.push('<td align="right" style="padding-right:5;" width="120">');
	c_html.push('<input type="hidden" id="tmp_vcart_price_'+vertual_cart_no+'" name="tmp_vcart_price_'+vertual_cart_no+'" value="'+total_price+'">');
	c_html.push('<input type="hidden" id="tmp_vcart_price2['+vertual_cart_no+']" name="tmp_vcart_price2" value="'+total_price+'">');
	c_html.push('<b><span id="view_vcart_price_'+vertual_cart_no+'">'+total_price_comma+' 원</span></b>');
	c_html.push('</td>');

	//옵션이 하나 밖에 없을때는 삭제안되도록
	if ( is_danil != 1 )
	{
		c_html.push('<td width="17"><a href="javascript:void(0);" onclick="vertual_cart_del(\''+vcart_id+'\',\''+vertual_cart_no+'\');"><img src="img/btn_cart_del.gif" border="0" align="absmiddle" alt="삭제"></a></td>');
	}
	else
	{
		c_html.push('<td width="17">&nbsp;</td>');
	}
	//옵션이 하나 밖에 없을때는 삭제안되도록
	
	c_html.push('<td width="7">&nbsp;</td>');
	c_html.push('</tr>');

	c_html.push('<tr><td style="background-color:#ddd; height:1px;" colspan="8"></td></tr>');

	c_html.push('</table>');
	//c_html.push('</td></tr></table>');
	//주문내역 전채를 감싸는 테이블이 필요합니다.
	c_html.push('</div>');

	//alert(c_html);



	//document.getElementById('debug').value = c_html.join("");
	
	if ( sel_values != "" )
	{
		vertual_cart_opt[vertual_cart_no] = tmp_title_total;
		//alert(vertual_cart_opt);
		vertual_cart_text[vertual_cart_no] = tmp_title_total;
		//alert(tmp_title_total);
		document.getElementById('vertual_cart').innerHTML += '' + c_html.join("");
		//document.getElementById('vertual_cart').innerHTML = c_html.join("");
		
		gubun_options.push(vertual_cart_no);

		//alert(c_html.join(""));
		vertual_cart_no++;

		document.getElementById('vertual_cart_table').style.display = '';
		
		//옵션합계금액
		total_price2 = option_price_total();

		//추가상품금액
		etc_price2 = etc_price_total();

		//document.getElementById('view_vcart_price_total').innerHTML = number_format(total_price2+etc_price2);


		//상품금액 추가됨
		cnt = document.regiform.length;
		quantity_total = 0;
		etc_price = 0;

		for ( i=0;i<cnt ;i++ )
		{
			if ( document.regiform[i].name.match("^want_quantity") )
			{
				quantity_total = quantity_total + parseFloat(document.regiform[i].value);
			}
		}

		//product_price = document.regiform.baro_price.value * quantity_total;
		//document.getElementById('view_vcart_product_price_total').innerHTML = number_format(product_price);

		//총결제금액
		//document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(product_price+total_price2+etc_price2);
		document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(total_price2+etc_price2);
		//합계금액

		
		//초기화
		//regiform_0();
		/*
		if ( select_array[2] )
		{
			select_array[2].selectedIndex = 0;
		}
		if ( select_array[3] )
		{
			select_array[3].selectedIndex = 0;
		}
		*/
		//초기화
	}
}

//가상장바구니 제거
function vertual_cart_del(v_cart,vertual_cart_no)
{
	//alert(v_cart);
	v_cart = document.getElementById(v_cart);
	vertual_cart_opt[vertual_cart_no] = "";
	vertual_cart_text[vertual_cart_no] = "";
	v_cart.innerHTML = '';
	v_cart.style.display = "none";

	view_table = 'none';
	if ( vertual_cart_text.length >= 1 )
	{
		//alert(vertual_cart_text.length);
		for ( already in vertual_cart_text )
		{
			
			if ( vertual_cart_text[already] != "" )
			{
				//alert("하나라도 있다.");
				view_table = '';
			}
		}
	}

	document.getElementById('vertual_cart_table').style.display = view_table;

	//옵션합계금액
	total_price2 = option_price_total();

	//추가상품금액
	etc_price2 = etc_price_total();

	//document.getElementById('view_vcart_price_total').innerHTML = number_format(total_price2+etc_price2);


	//상품금액 추가됨
	cnt = document.regiform.length;
	quantity_total = 0;
	etc_price = 0;

	for ( i=0;i<cnt ;i++ )
	{
		if ( document.regiform[i].name.match("^want_quantity") )
		{
			quantity_total = quantity_total + parseFloat(document.regiform[i].value);
		}
	}

	//product_price = document.regiform.baro_price.value * quantity_total;
	//document.getElementById('view_vcart_product_price_total').innerHTML = number_format(product_price);

	//총결제금액
	//document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(product_price+total_price2+etc_price2);
	document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(total_price2+etc_price2);
	//합계금액

}

//가상장바구니 수량 변경
function vertual_cart_quantity(vertual_cart_no)
{
	//alert(vertual_cart_no);
	//추가상품이다
	if ( document.getElementById('want_quantity['+vertual_cart_no+']') == undefined )
	{
		quantity_v = document.getElementById('etc_want_quantity['+vertual_cart_no+']').value;
		price_v = document.getElementById('etc_price_'+vertual_cart_no).value;
		quantity_v = quantity_v.replace(/[^0-9]?/g,"");

		want_quantity = document.getElementById('etc_want_quantity['+vertual_cart_no+']');
		want_quantity.value = quantity_v;
		tmp_quantity = 0 + parseInt(want_quantity.value);

		jaego_check = false;
	}
	//옵션이다
	else
	{
		quantity_v = document.getElementById('want_quantity['+vertual_cart_no+']').value;
		price_v = document.getElementById('tmp_vcart_price_'+vertual_cart_no).value;
		quantity_v = quantity_v.replace(/[^0-9]?/g,"");

		want_quantity = document.getElementById('want_quantity['+vertual_cart_no+']');
		want_quantity.value = quantity_v;
		tmp_quantity = 0 + parseInt(want_quantity.value);

		jaego_check = true;
	}

	if ( tmp_quantity <= 0 )
	{
		want_quantity.value = 1;
		return;
	}



	if ( quantity_v >= 1 && jaego_check == true )
	{
		
		//재고를 체크 해야 하며
		//최대구매수량을 체크 해야 한다.
		product_number = document.getElementById('links_number').value;
		option_number = document.getElementById('search_category2['+vertual_cart_no+']').value;
		nDate	= new Date();
		nowTime	= nDate.getTime();



		linkUrl = "./ajax_jaego_check.php";
		linkUrl+= "?product_number="+product_number;
		linkUrl+= "&option_number="+option_number;
		linkUrl+= "&want_quantity="+quantity_v;
		linkUrl+= "&vertual_cart_no="+vertual_cart_no;
		linkUrl+= "&nowTime="+nowTime;

		//alert(linkUrl);

		handleFunc = "quantity_check";

		happyStartRequest( linkUrl, handleFunc );
		
	}


	price = 0 + ( price_v * quantity_v );
	price = price * 100 / 100;

	document.getElementById('view_vcart_price_'+vertual_cart_no).innerHTML = number_format(price)+" 원";
	
	//옵션합계금액
	total_price2 = option_price_total();

	//추가상품금액
	etc_price2 = etc_price_total();

	//document.getElementById('view_vcart_price_total').innerHTML = number_format(total_price2+etc_price2);


	//상품금액 추가됨
	cnt = document.regiform.length;
	quantity_total = 0;
	etc_price = 0;

	for ( i=0;i<cnt ;i++ )
	{
		if ( document.regiform[i].name.match("^want_quantity") )
		{
			quantity_total = quantity_total + parseFloat(document.regiform[i].value);
		}
	}

	//product_price = document.regiform.baro_price.value * quantity_total;
	//document.getElementById('view_vcart_product_price_total').innerHTML = number_format(product_price);

	//총결제금액
	//document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(product_price+total_price2+etc_price2);
	document.getElementById('view_vcart_pay_price_total').innerHTML = number_format(total_price2+etc_price2);
	//합계금액
}


function quantity_check(values)
{
	//alert(values);
	result_value = values.split("___cut___");
	//alert(result_value[0]); //true or false
	//alert(result_value[1]); //reason
	//alert(result_value[2]); //vertual_cart_no
	//alert(result_value[3]); //jaego

	if ( result_value[0] == "false" )
	{
		if ( result_value[1] == "max_buy_over" )
		{
			str = "구매가 가능한 최대 개수를 초과하셨습니다.\n["+result_value[3]+"]개 이하로 주문이 가능합니다.";
			alert(str);
		}
		else if ( result_value[1] == "jaego_over" )
		{
			str = "현재 재고가 부족합니다. \n["+result_value[3]+"]개 이하로 주문이 가능합니다.";
			alert(str);
		}

		vertual_cart_no_tmp = result_value[2];
		want_quantity = document.getElementById('want_quantity['+vertual_cart_no_tmp+']');
		
		//재고가 0일이고 주문개수를 줄였을때 무한루프 돌던거 패치 2011-08-29 kad
		if ( result_value[3] == 0 )
		{
			want_quantity.value = 0;
		}
		else
		{
			want_quantity.value = 1;
		}
		//재고가 0일이고 주문개수를 줄였을때 무한루프 돌던거 패치 2011-08-29 kad

		vertual_cart_quantity(vertual_cart_no_tmp);
	}
}



//가상장바구니 수량 + 1
function quantity_plus(vertual_cart_no)
{
	//alert(vertual_cart_no);
	if ( document.getElementById('want_quantity['+vertual_cart_no+']') == undefined )
	{
		want_quantity = document.getElementById('etc_want_quantity['+vertual_cart_no+']');
	}
	else
	{
		want_quantity = document.getElementById('want_quantity['+vertual_cart_no+']');
	}

	tmp_quantity = 0 + parseInt(want_quantity.value) + 1;

	if ( tmp_quantity <= 0 )
	{
		return;
	}
	else
	{
		want_quantity.value = tmp_quantity;
	}
}


//가상장바구니 수량 -1
function quantity_minus(vertual_cart_no)
{
	//alert(vertual_cart_no);
	if ( document.getElementById('want_quantity['+vertual_cart_no+']') == undefined )
	{
		want_quantity = document.getElementById('etc_want_quantity['+vertual_cart_no+']');
	}
	else
	{
		want_quantity = document.getElementById('want_quantity['+vertual_cart_no+']');
	}

	tmp_quantity = 0 + parseInt(want_quantity.value) - 1;

	if ( tmp_quantity <= 0 )
	{
		return;
	}
	else
	{
		want_quantity.value = tmp_quantity;
	}
}

//텍스트에서 가격 과 제목을 분리
function separate_title(str,type)
{
	//(+10) 이란 문자열만 가격으로 인정한다.
	gubunja_1 = "（가격:";
	gubunja_2 = ")";
	
	tmp_str = str.split(gubunja_1);
	//alert(tmp_str[1]);

	if ( tmp_str[1] )
	{
		price_str = tmp_str[1].split(gubunja_2);
	}
	else
	{
		price_str = new Array();
		//price_str.push(0);
	}

	if ( type == "title" )
	{
		return_str = tmp_str[0];
	}
	else if ( type == "price" )
	{
		return_str = price_str[0];
		
		if ( return_str != undefined )
		{
			//return_str = parseFloat(return_str.replace(/[^0-9]?/g,""));
			return_str = return_str.replace("\+","");
			return_str = return_str.replace(/,/g,"");
			return_str = return_str.replace("\$","");
			return_str = return_str.replace("원","");

			if ( return_str.indexOf('.') != -1 )
			{
				return_str = parseFloat(return_str);
				return_str = return_str.toFixed(2);
			}
		}
		//alert(price_str[0]+":"+return_str);
	}

	return return_str;
}

//금액콤마
function number_format(numstr)
{
	var numstr = String(numstr);
	var re0 = /(\d+)(\d{3})($|\..*)/;
	if (re0.test(numstr))
	{
		return numstr.replace(re0,function(str,p1,p2,p3) { return number_format(p1) + "," + p2 + p3; });
	}
	else
	{
		return numstr;
	}
}

//가상장바구니 관련 스크립트

//cleartime
function addLoadEvent(func)
{
	var oldonload = window.onload;

	if ( typeof window.onload != 'function' )
	{
		window.onload = func;
	}
	else
	{
		window.onload = function()
		{
			oldonload();
			func();
		}
	}
}
//cleartime


//단일옵션상품일경우 초기값 지정
function set_danil_option()
{
	//alert(happyRequest.readyState);
	if ( happyRequest.readyState == 4 )
	{
		document.regiform.search_category1.selectedIndex = 1;
		document.regiform.search_category2.selectedIndex = 1;
		vertual_cart();
		clearTimeout(danil_timer);
	}
	else
	{
		danil_timer = setTimeout("set_danil_option()",100);
	}
}
//단일옵션상품일경우 초기값 지정


//옵션합계금액
function option_price_total()
{
	//alert(gubun_options);
	cnt = gubun_options.length
	total_price2 = 0;
	for (i=0;i<cnt ;i++ )
	{
		//alert('etc_price2['+etc_options[i]+']');
		if ( document.getElementById('tmp_vcart_price2['+gubun_options[i]+']') != undefined )
		{
			price_obj = document.getElementById('tmp_vcart_price2['+gubun_options[i]+']');
			quantity_obj = document.getElementById('want_quantity['+gubun_options[i]+']');
			total_price = parseFloat(price_obj.value * quantity_obj.value);
			total_price2 = 0 + total_price2 + total_price ;
		}
	}

	return total_price2;
}


//추가상품금액
function etc_price_total()
{
	cnt = etc_options.length
	etc_price2 = 0;
	for (i=0;i<cnt ;i++ )
	{
		//alert('etc_price2['+etc_options[i]+']');
		if ( document.getElementById('etc_price2['+etc_options[i]+']') != undefined )
		{
			price_obj = document.getElementById('etc_price2['+etc_options[i]+']');
			quantity_obj = document.getElementById('etc_want_quantity['+etc_options[i]+']');
			etc_price = parseFloat(price_obj.value * quantity_obj.value);
			etc_price2 = 0 + etc_price2 + etc_price ;
		}
	}

	return etc_price2;
}

//####################옵션주문관련 스크립트 END####################




//판매금액타입으로 인해 생겨남
function CookieValue(name) {
try
{
 var cookie_name = name + "=";
 var ca = document.cookie.split(";");
 for (var i = 0; i < ca.length; i++) {
  var c = ca[i];

  while (c.charAt(0) == " ") c = c.substring(1, c.length);
  if (c.indexOf(cookie_name) == 0) return c.substring(cookie_name.length, c.length);
 }
 return null;
}
 catch (exception) { }
}


function add_bookmark_click()
{
	try
	{
		window.external.AddFavorite(parent.location.href, document.title);
	}
	catch (e)
	{
		alert("Ctrl+D 키를 누르면 즐겨찾기에 추가하실수 있습니다.");
	}
}

