if(typeof postCommon=="undefined"){var postCommon={}}postCommon.Tag=$Class({$init:function(){this.restrictedTagChars=tagNameValidator.restrictedTagChars;this.tagData=null;this.currentTarget=null;this.isAlreadySubmit=false},isTagname:function(a){return tagNameValidator.isTagname(a)},validateTagString:function(b){var a=b.replace(this.restrictedTagChars,"");re=/[\x2c]+/g;return a.replace(re,",")},absoluteTagString:function(b,g){var f=this.validateTagString(b);var e=f.split(",");var d="";var a=e.length;if(a>g){a=g}for(var c=0;c<a;c++){d=d+e[c]+","}d=this.validateTagString(d);d=d.substring(0,d.length-1);return d},check_tagsvalidate:function(a,b,h){var e=true;var d=$$.getSingle("~ div",b);var f=$$.getSingle("input",d);f.value=this.validateTagString(f.value);f.value=this.eliminateDuplicate(f.value);var g=f.value.split(",").length;if(h){h.call()}if(g.length==1&&g[0].length==0){f.focus();alert("태그를 입력해주세요");return false}if(g>10){alert("태그는 최대 10개 까지 입력이 가능합니다.");f.value=this.absoluteTagString(f.value,10);f.focus();return false}var j;var c=100;j=this.isValidateTagLength(f.value,c);if(!j){alert("태그는  100자 이상 입력할 수 없습니다.");f.focus();return false}return true},check_tagvalidate:function(a,c){var b=a.value;if(b.match(this.restrictedTagChars)!=null){b=b.replace(this.restrictedTagChars,"");a.value=b}var d=/[\x2c][\x2c]+/g;if(b.match(d)!=null){b=b.replace(d,",");a.value=b}if(c){c.call()}},eliminateDuplicate:function(b){var f=this.validateTagString(b);var e=f.split(",");var d="";for(var c=0;c<e.length;c++){for(var a=0;a<c;a++){if(e[a]==e[c]){e[c]=""}}d=d+e[c]+","}d=this.validateTagString(d);d=d.substring(0,d.length-1);return d},isValidateTagLength:function(a,c){var d=a.split(",");for(var b=0;b<d.length;b++){if(d[b].length>c){return false}}return true},getLogNoFromTagQuery:function(e){var c=[];if(!e){return c}var d=e.split("&");for(var b=0,a=d.length;b<a;b++){if(!d[b]){continue}c.push(d[b].replace(/logNo=/,""))}return c},loadTagInfo:function(a,e){var c=e||tagParam;var d=this.getLogNoFromTagQuery(c);var b="/BlogTagListInfo.nhn";new $Ajax(b,{method:"post",onerror:function(){},onload:$Fn(function(f){this.tagData=[];if(typeof f!="undefined"){try{var j=f.json();if(!j){return}j=j.taglist;this.tagData=j;if(a=="popup"){this.callbackSaveTagInfo(j)}else{if(a=="list"){if(j.length>0){for(i=0;i<j.length;i++){this.setTagList(j[i].logno,j[i].tagName,(j.length-1==i)?"resize":null,$("tagTopName_"+j[i].logno),j[i].encTagName)}}}else{if(j.length>0){if(isMemolog){for(i=0;i<j.length;i++){this.setTagList(j[i].logno,j[i].tagName,(j.length-1==i)?"resize":null,$("tagTopName_"+j[i].logno),j[i].encTagName)}}for(i=0;i<j.length;i++){if($("tagList_"+j[i].logno)!=null){$("tagList_"+j[i].logno).style.display=""}this.setTagList(j[i].logno,j[i].tagName,(j.length-1==i)?"resize":null,$("tagList_"+j[i].logno),j[i].encTagName)}}}}}catch(g){var h=$$("div.post-tag[@display=block]");nCount=h.length;for(i=0;i<nCount;i++){$Element(h[i]).hide()}}}},this).bind()}).request({blogId:blogId,logNoList:d.join("|"),logType:(isMemolog?"memolog":"mylog")})},loadTagListTableInfo:function(a){this.loadTagInfo("list",a)},setTagList:function(g,r,m,b,n){var f=$Element(b);if(!f){return}var d=isMemolog?"memolog":"mylog";var l=false;var q=false;var k=utility.decodeURIComponentForJava(r).split(",");var p=n==undefined||n=="undefined"?k:n.split("%2C");var a='&nbsp;<a href="#" class="_showTagEditBox _rosRestrict _tagRosRestrict _param(EDIT|'+g+') _returnFalse"><img src="'+imageURL+'/nblog/btn_edit_2.gif" width="23" height="11" alt="edit"/></a>';var j=[];if(f.$value()==$("tagTopName_"+g)){q=true;a='&nbsp;<a href="#" class="_showTagEditBox _rosRestrict _tagRosRestrict _param(EDIT|'+g+'|TOP) _returnFalse" ><img src="'+imageURL+'/nblog/btn_edit_2.gif" width="23" height="11" alt="edit"/></a>'}for(var o=0,c=k.length;o<c;o++){var s;var e;if(k[o]==""){l=true}else{s=k[o];e=p[o];j.push('<a href="/PostListByTagName.nhn?blogId='+blogId+"&logType="+d+"&tagName="+e+"\" class=\"tag pcol1 itemTagfont _setTop\" onclick=\"clickcr(this,'tag.list','','',event)\"><span>#"+s+"</span></a>")}}var h=utility.getParam(f.className());if(!isMemolog){if(blogOwner){j.push(a)}}else{if(blogOwner||h&&h[0]=="true"){j.push(a)}}f.html(j.join(""));if(!q&&!l){f.show()}},setTagForLogNo:function(c){for(var b=0,a=this.tagData.length;b<a;b++){if(this.tagData[b].logno==c[0].logno){this.tagData[b]=c[0];return}}this.tagData.push(c[0])},getTagForLogNo:function(a){for(var c=0,b=this.tagData.length;c<b;c++){if(this.tagData[c].logno==a){return utility.decodeURIComponentForJava(this.tagData[c].tagName)}}},showTagEditBox:function(b,g){var a=$$.getSingle("~ div",g);var f=$$.getSingle("input",a);var c=this.getTagForLogNo(b);var d=utility.trim(c);var e=utility.unescapeUnicode(d);f.value="#"+e.split(/[,\s#]+/g).join(", #");$Element(g).hide();$Element(a).show();f=a=g=null},hideTagEditBox:function(b,c){var a=$$.getSingle("~ div",c);if(c.id.indexOf("tagTopName_")==-1||!blogOwner){$Element(c).show()}else{$Element(c).css({display:""})}$Element(a).hide();a=c=null},saveTag:function(b,c){var a=true;a=this.check_tagsvalidate(b,c);if(a){this.realSaveTag(b,c)}},realSaveTag:function(b,e){var a=$$.getSingle("~ div",e);var d=$$.getSingle("input",a);var c=$("saveTagName");this.currentTarget=e;c.logNo.value=b;c.chtagname.value=utility.trim(d.value);if(isMemolog){c.logType.value="memolog"}if(this.isAlreadySubmit){return}this.changeAlreadySubmitValue(true);c.submit();c=d=a=e=null},callbackSaveTagInfo:function(aTagList){this.changeAlreadySubmitValue(false);if(typeof(aTagList)=="string"){aTagList=eval("("+aTagList+")").taglist}if(aTagList.length>0){this.setTagForLogNo(aTagList);for(var i=0,nCount=aTagList.length;i<nCount;i++){var oTag=aTagList[i];if(this.currentTarget!=null){this.hideTagEditBox(oTag.logno,this.currentTarget)}this.setTagList(oTag.logno,oTag.tagName,"resize",$("tagList_"+oTag.logno),oTag.encTagName);this.setTagList(oTag.logno,oTag.tagName,"resize",$("tagTopName_"+oTag.logno),oTag.encTagName)}}},changeAlreadySubmitValue:function(a){this.isAlreadySubmit=a}});var postListTag=new postCommon.Tag();var AdPostList=$Class({$init:function(a,e,b,d,c){this.nLogNo=a;this.nDirectorySeq=e;this.nIndex=b;this.bOldPostOneWeek=d;this.sModifyDateValue=c}});var AdPostObject=$Class({sBlogId:"",sAdPostSecurityParam:"",oContentShareObject:null,bExistAdPost:false,bUseAdPostInSide:false,aPostList:[],nCategoryDirectorySeq:0,nFirstLogNo:"",bPreview:false,bPreviewContent:false,bPreviewSide:false,nAlign:0,nCount:3,sContentSpanIdPrefix:"adPostInjectArea_",sSideSpanIdPrefix:"adPostWidget",bRemoconPreview:false,addAdPostList:function(a,e,b,d,c){this.aPostList.push(new AdPostList(a,e,b,d,c))},isPrintPreview:function(){return this.bPreviewContent||this.bPreviewSide},cannotViewCase:function(){return !this.oContentShareObject&&this.bUseAdPostInSide},isShowAdPost:function(){return !this.bPreview&&this.bExistAdPost&&!this.cannotViewCase()},isCleanSideAdPost:function(){return !this.bExistAdPost&&this.oContentShareObject&&$(this.sSideSpanIdPrefix)&&!this.bPreview}});var AdPostInject=$Class({oAdPost:null,$init:function(a){this.oAdPost=a},injectAdPost:function(){if(this.oAdPost.oContentShareObject){this._setAttributes();if(this.oAdPost.isPrintPreview()){this._preview();return}}this._injectAdPost();this._cleanSideAdPost()},_setAttributes:function(){this.oAdPost.bPreview=this.oAdPost.oContentShareObject.adPostPreview;this.oAdPost.bPreviewContent=this.oAdPost.oContentShareObject.adPostPreviewContent;this.oAdPost.bPreviewSide=this.oAdPost.oContentShareObject.adPostPreviewSide;this.oAdPost.nAlign=this.oAdPost.oContentShareObject.adPostAlign;this.oAdPost.nCount=this.oAdPost.oContentShareObject.adPostCount},_preview:function(){new $Ajax("/AdPostInjectPreviewAsync.nhn",{method:"POST",onload:$Fn(function(a){this._onLoadPreview(a)},this).bind()}).request({blogId:this.oAdPost.sBlogId,adPostArea:this.oAdPost.bPreviewSide?"1":"0",adPostAlign:this.oAdPost.nAlign,adPostCount:this.oAdPost.nCount})},_onLoadPreview:function(a){if(this.oAdPost.bPreviewSide&&parent.$(this.oAdPost.sSideSpanIdPrefix)){parent.$(this.oAdPost.sSideSpanIdPrefix).innerHTML=a.text()}else{if(this.oAdPost.bPreviewContent){var c=this.oAdPost.sContentSpanIdPrefix+this.oAdPost.nFirstLogNo;var b=this.oAdPost.bRemoconPreview?parent.$(c):$(c);if(b){b.innerHTML=a.text()}}}},_getTopReferer:function(){if(parent.g_ShareObject){return parent.g_ShareObject.referer}if(parent.parent.g_ShareObject){return parent.parent.g_ShareObject.referer}return encodeURIComponent(document.referrer)},_injectAdPost:function(){if(this.oAdPost.isShowAdPost()){new $Ajax("/AdPostInjectAsync.nhn",{method:"POST",onload:$Fn(function(a){this._onLoadADInject(a)},this).bind()}).request(this._getInjectParams())}},_getInjectParams:function(){var c={};c.blogId=this.oAdPost.sBlogId;c["adPostInjectSecurity.sp"]=this.oAdPost.sAdPostSecurityParam;c["configure.adCount"]=this.oAdPost.nCount;c["configure.adAlign"]=this.oAdPost.nAlign;c["configure.categoryDirectorySeq"]=this.oAdPost.nCategoryDirectorySeq;c["configure.topReferer"]=this._getTopReferer();c["configure.requestReferer"]=encodeURIComponent(document.referrer);for(var b=0;b<this.oAdPost.aPostList.length;b++){var a=this.oAdPost.aPostList[b];c["configure.adPostInjectParams["+a.nIndex+"].logNo"]=a.nLogNo;c["configure.adPostInjectParams["+a.nIndex+"].directorySeq"]=a.nDirectorySeq;c["configure.adPostInjectParams["+a.nIndex+"].oldPostOneWeek"]=a.bOldPostOneWeek}return c},_onLoadADInject:function(b){if(b.text().indexOf('"logNo"')>-1){var e=b.json();for(var a=0;a<e.length;a++){if(this.oAdPost.oContentShareObject&&e[a].inSide&&$(this.oAdPost.sSideSpanIdPrefix)){$(this.oAdPost.sSideSpanIdPrefix).innerHTML=e[a].content}else{if(e[a].inPost){var d=this.oAdPost.sContentSpanIdPrefix+e[a].logNo;var c=$Element($(d));if(c){c.html(e[a].content)}}}}if(e.length==0&&this.oAdPost.oContentShareObject&&$(this.oAdPost.sSideSpanIdPrefix)){$Element($(this.oAdPost.sSideSpanIdPrefix)).html("")}}},_cleanSideAdPost:function(){if(this.oAdPost.isCleanSideAdPost()){$Element(parent.$(this.oAdPost.sSideSpanIdPrefix)).html("")}}});var InstallBlogAppPush=$Class({$init:function(){$Fn(this._onClick,this).attach(document,"click")},_onClick:function(b){var c=b.element;var a=$Element($$.getSingle("!a",c)?$$.getSingle("!a",c):c);var d;if(typeof(paramUtil)!="undefined"){d=paramUtil.getParam(a.className())}else{d=utility.getParam(a.className())}if(a.hasClass("_installBlogAppPush")){this._push(d,false)}else{if(a.hasClass("_installBlogAppPushClose")){this._closeLayer(d)}else{if(a.hasClass("_installBlogAppPushRetry")){this._push(d,true)}}}if(a.hasClass("_stopIntallAppEvent")){b.stop()}},_push:function(c,b){var d="";var a=c[0];if(c.length>=2){d=c[1]}if(a=="true"){this._callPush(d,b)}else{this._login()}},_login:function(){var a=encodeURI("http://"+location.host+"/ReloadOpenerAndClose.nhn");window.open("https://nid.naver.com/nidlogin.login?mode=form&svctype=64&url="+a,"login","width=400,height=260,location=no,resizable=no")},_callPush:function(b,a){new $Ajax("/InstallBlogAppPushAsync.nhn",{method:"POST",onload:$Fn(function(c){this._showLayer(c,b,a)},this).bind()}).request()},_showLayer:function(a,c,b){if(a.text()=="success"){$Element("installBlogAppPush"+c).show();$Fn(this._hideInstallBlogAppPushNews,this).attach($$("#myBlogNews ._installBlogAppPushClose"),"keydown");if(b){alert("알림을 다시 전송했습니다.")}}else{if(a.text()=="login"){this._login()}else{alert("일시적인 문제로 접속 할 수 없습니다. 잠시 후 다시 시도해주세요.")}}},_closeLayer:function(a){var b="";if(a.length>=2){b=a[1]}$Element("installBlogAppPush"+b).hide()},_hideInstallBlogAppPushNews:function(a){if(a.key().keyCode!=13){return}$Element("installBlogAppPushNews").hide();$("installBlogAppPush").focus();a.stop()}});if(typeof(window.defineNHNJS)=="undefined"){window.defineNHNJS={}}window.defineNHNJS["PostBottomCommon_utf8-573709510_js"]=true;
