/*! SmartEditor3 - v1.0.0 - 2017-12-11
* Copyright (c) 2017 NAVER Corp; Licensed  */

(function(){var a={init:function(a,b,c){this._initVar(a,b,c);this._assignElements();this._removeOnClickBlocker();if(this._isSE3Blog){if(this._isNaver){if(this._isMobile){this._showMapViewBtn()}else{this._activateDynamicMap()}}}else if(this._isSE3Post){if(this._isCardDoc){if(this._isMobile){this._fixBrokenLogo()}this._htElement.$elMap.show()}}if(this._isMobile&&this._isDialAvailable()){this._showDialBtn()}this._attachEvents();this.trigger("onMapLoad",{baseEl:this._htElement.$elBase,mapButtonEl:this._htElement.$elMapBtn})},_initVar:function(a,b,c){this._htConfig=b||{};this._htInjectionData=c||{};this._htData={nMarkerLatitude:parseFloat(a.markerLatitude,10),nMarkerLongitude:parseFloat(a.markerLongitude,10),nZoomLevel:parseFloat(a.zoomLevel,10),sSearchEngine:a.searchEngine,sSearchType:a.searchType,sPlaceId:a.locationId,sViewId:a.viewId};this._htConst={CARD:"CARD",NAVER:"NAVER",GOOGLE:"GOOGLE",htServiceId:{BLOG:"blog",POST:"post"},htBizCatcher:{sCallSource:{blog:"BLOG",post:"POST"}},sClassOn:"is-on",htLogoHeight:{NAVER:30,GOOGLE:45},nStaticMapOriginalHeight:748,htMaxBrokenMapRatio:{NAVER:816/688,GOOGLE:816/658},nNormalMapRatio:816/748};var d=this._htConfig.SERVICE_ID;this._isSE3Blog=d===this._htConst.htServiceId.BLOG;this._isSE3Post=d===this._htConst.htServiceId.POST;this._isMobile=se.module.isMobile();this._sServiceId=d;var e=a.searchEngine;this._isNaver=e===this._htConst.NAVER;this._isGoogle=e===this._htConst.GOOGLE;var f=this._htConfig.VIEWER_TYPE;this._isCardDoc=f===this._htConst.CARD;var g=this._htConfig.API_URL_HOST;this._sDialNumberAPI=g+"/cocoa-api/api.nhn";this._htMessage={NO_DIAL_NUMBER:"전화번호가 제공되지 않는 업체입니다.",DIAL_NUMBER_API_ERROR:"일시적인 오류로 전화번호를 조회할 수 없습니다.\n잠시 후에 다시 이용해 주세요.",NO_RESERVE:"예약 서비스가 삭제되었거나,\n일시적으로 예약이 중지된 상태입니다.",RESERVE_API_ERROR:"일시적인 오류로 예약 페이지를 조회할 수 없습니다.\n잠시 후에 다시 이용해 주세요."}},_assignElements:function(){var a={};a.$elBase=$jq("#"+this._htData.sViewId);a.$elMapWrapper=a.$elBase.find(".se_mediaArea");var b=a.$elBase.find("script#"+this._htData.sViewId+"_map_view_link");if(b[0]){var c=b.html();a.$elMapBtn=$jq(c)}else{a.$elMapBtn=a.$elBase.find("a.se_map_bSizeView")}a.$elMapBtn.removeClass("se_map_bSizeView").addClass("se_map_link");a.$elMapWrapper.append(a.$elMapBtn);a.$elLinks=a.$elBase.find("a.__se_link");a.$elMap=this._isCardDoc?a.$elMapWrapper.find("div.se_card_mapView"):a.$elMapWrapper.find("img");a.$elWrapperArea=a.$elBase.find("div.se_info_btn");a.$elWrapperAreaParent=a.$elWrapperArea.parent().addClass("is-contact");a.$elDialBtn=a.$elBase.find("a.btn_tel");a.$elReserveBtn=a.$elBase.find("a.__se_btn_booking");this._htElement=a},_attachEvents:function(){var a=this._htElement;if(a.$elDialBtn&&a.$elDialBtn[0]){a.$elDialBtn.on("click",this._onClickDialBtn.bind(this))}if(a.$elReserveBtn&&a.$elReserveBtn[0]){a.$elReserveBtn.on("click",this._onClickReserveBtn.bind(this))}},_onClickDialBtn:function(a){this._requestMapInfo(this._onSuccessDialNumber.bind(this),this._onFailDialNumber.bind(this));a.preventDefault()},_onSuccessDialNumber:function(a){var b;if(a.message&&a.message.result){b=a.message.result.phone}if(!b){alert(this._htMessage.NO_DIAL_NUMBER);return}this._dial(b)},_onFailDialNumber:function(){alert(this._htMessage.DIAL_NUMBER_API_ERROR)},_onClickReserveBtn:function(a){this._requestMapInfo(this._onSuccessReserve.bind(this),this._onFailReserve.bind(this));a.preventDefault()},_onSuccessReserve:function(a){var b;if(a.message&&a.message.result){b=a.message.result.reserve_url}if(!b){alert(this._htMessage.NO_RESERVE);return}this._openReserveUrl(b)},_onFailReserve:function(){alert(this._htMessage.RESERVE_API_ERROR)},_requestMapInfo:function(a,b){$jq.ajax(this._sDialNumberAPI,{method:"GET",dataType:"jsonp",crossDomain:true,cache:false,data:{m:"snippet",id:this._htData.sPlaceId,type:"json"},success:a,error:b,timeout:b})},_updateDialBtn:function(a){var b=this._htElement.$elDialBtn;var c=this._getDialScheme(a);b.attr("href",c);b.attr("data-for-biz-catcher","mainNumber="+a+"&callSource="+this._htConst.htBizCatcher.sCallSource[this._sServiceId]+"&description="+this._htData.sPlaceId)},_dial:function(a){this._updateDialBtn(a);this._callBizCatcherScript()},_openReserveUrl:function(a){if(this._isMobile){location.href=a}else{window.open(a)}},_getDialScheme:function(a){return"tel:"+a},_callBizCatcherScript:function(){sendToBizCatcher(this._htElement.$elDialBtn[0])},_removeOnClickBlocker:function(){this._htElement.$elLinks.attr("onclick",null)},_showMapViewBtn:function(){if(!this._htElement.$elMapBtn[0]){return}this._htElement.$elMapBtn.show()},_showDialBtn:function(){if(this._htElement.$elReserveBtn){this._htElement.$elWrapperAreaParent.addClass("is-contact-all")}this._htElement.$elDialBtn.addClass(this._htConst.sClassOn)},_isDialAvailable:function(){return this._isNaver&&this._htData.sSearchType&&this._htData.sSearchType!=="P"},_fixBrokenLogo:function(){var a=this._htElement.$elMap;var b=this._htElement.$elMapWrapper;var c=this._htData.sSearchEngine;var d=this._htConst.htMaxBrokenMapRatio[c];var e=this._htConst.nNormalMapRatio;try{var f=parseFloat(b.css("width"),10);var g=parseFloat(b.css("height"),10);var h=f/g;var i=f/e;var j=f/d;var k=g>j&&g<i;var l;var m;var n;if(k){m=i+this._htConst.htLogoHeight[c]*(g/this._htConst.nStaticMapOriginalHeight)*2;n=m*e;l=""+n+"px "+m+"px";a[0].style.backgroundSize=l}}catch(o){if(window.console){console.log(o)}}},_activateDynamicMap:function(){var a=this._htElement.$elMap;var b;try{var c=a.css("width");var d=a.css("height");a.hide();b=$jq('<div class="__se_map"></div>');this._htElement.$elMapWrapper.append(b);b.css({width:c,height:d});var e=this._htData.nZoomLevel||12;var f=new naver.maps.LatLng(this._htData.nMarkerLatitude,this._htData.nMarkerLongitude);var g={center:f,zoom:e,minZoom:1,zoomControl:false,mapTypeId:"normal"};var h=new naver.maps.Map(b[0],g);var i=new naver.maps.Marker({icon:"https://ssl.pstatic.net/static/maps/v3/pin_default.png",position:f,map:h})}catch(j){if(b&&typeof b.hide==="function"){b.hide()}a.show();if(window.console){console.log(j)}}}};se.defineComponent("se.module.v1.Map",a);se.defineComponent("se.module.v1.m.Map",a)})();
//# sourceMappingURL=se.module.v1.Map.min.js.map