"undefined"==typeof nhn&&(nhn={}),nhn.mobile=nhn.mobile||{},nhn.mobile.search=nhn.mobile.search||{},nhn.mobile.search.total_web=nhn.mobile.search.total_web||{},nhn.mobile.search.total_web.Controller=eg.Class.extend(eg.Component,{construct:function(t){var e={sBaseSelector:null,sContainerSelector:"._carousel",sItemSelector:"._item",sPersistKey:"total_web",sLazyLoadAttr:"data-src",nScrollLatency:100};this.option(e),this.option(t||{}),this.option("sBaseSelector")&&(this._initVars(),this._attachEvent())},_initVars:function(){this._$base=jQuery(this.option("sBaseSelector")),this._$containers=this._$base.find(this.option("sContainerSelector")),this._$items=this._$base.find(this.option("sItemSelector")),this._$imgs=this._$items.find("img"),this._sPersistKey=this.option("sPersistKey"),this._oPersist=new Persist,this._htImgLoadCount=[],this._$containers.each(jQuery.proxy(function(t,e){var i=jQuery(e),n=i.find("img").length,o=i.find("img["+this.option("sLazyLoadAttr")+"]").length;this._htImgLoadCount[t]={nImgNum:n,nLoadCount:n-o},this._isAllLoadCompleted(t)&&this._resizeImg(i)},this))},_attachEvent:function(){this._$containers.on("scroll",jQuery.proxy(this._debounce(this._onScrollContainer,this.option("nScrollLatency")),this)),this._$imgs.on({load:jQuery.proxy(this._onLoadImg,this),error:jQuery.proxy(this._onLoadImg,this)}),jQuery(window).on("rotate",jQuery.proxy(this._onRotate,this))},_onScrollContainer:function(t){var e=this._$containers.index(t.currentTarget),i=jQuery(t.currentTarget).data("area");this.trigger("scroll",{itemIndex:e,area:i})},_onLoadImg:function(t){var e=jQuery(t.currentTarget),i=e.closest(this.option("sContainerSelector")),n=this._getContainerIndex(i);this._htImgLoadCount[n].nLoadCount++,this._isAllLoadCompleted(n)&&this._resizeImg(i)},_onRotate:function(){this._$containers.each(jQuery.proxy(function(t,e){var i=jQuery(e);this._isAllLoadCompleted(t)&&(this._refreshImgResize(i),this._resizeImg(i))},this))},_resizeImg:function(t){var e=t.find(this.option("sItemSelector")),i=t.width(),n=0,o=0;if(e.each(function(t,e){var i=jQuery(e);n+=i.width(),o+=parseInt(i.css("margin-left"),10)+parseInt(i.css("margin-right"),10)}),i>n+o){var s=(i-o)/n;e.each(function(t,e){var i=jQuery(e),n=i.find("img"),o=i.height(),r=n.width()*s,a=n.height()*s;i.width(r+"px"),n.css({position:"absolute",width:r+"px",height:a+"px",left:0,top:(o-a)/2+"px"})})}},_refreshImgResize:function(t){t.find(this.option("sItemSelector")).width(""),t.find("img").css({position:"static",width:"",height:"",top:"",left:""})},_isAllLoadCompleted:function(t){var e=this._htImgLoadCount[t];return e.nImgNum<=e.nLoadCount},_getContainerIndex:function(t){return this._$containers.index(t)},_debounce:function(t,e,i){var n,o,s,r,a,h=function(){var c=(new Date).getTime()-r;e>c&&c>=0?n=setTimeout(h,e-c):(n=null,i||(a=t.apply(s,o),n||(s=o=null)))};return function(){s=this,o=arguments,r=(new Date).getTime();var c=i&&!n;return n||(n=setTimeout(h,e)),c&&(a=t.apply(s,o),s=o=null),a}}});