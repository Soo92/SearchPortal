var e={_bAvailable:!1,_bIsTablet:!1,_bIsAndroid:null,_bIsIos:null,_hAppInfo:null,_nOsVersion:0,_hAndroid:{sAppStoreUrl:"market://details?id=com.nhn.android.search",sAddInternalScheme:"naverapp://mysection",sAddExternalScheme:"Intent://mysection",nVersion:24,nServiceCode:540,bUsePadding:!1},_hIos:{sAppStoreUrl:"itms://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=393499958&mt=8",sAddInternalScheme:"naverapp://mysection",sAddExternalScheme:"naversearchapp://mysection",nVersion:23,nServiceCode:570},init:function(){this._setOsVersion(),this._checkEnvironment(),this._placeButtons()},_placeButtons:function(){var e=document.getElementsByClassName("nv-openmain");if(!(null===e||e.length<1))for(var t=0;t<e.length;t++){var n=e[t],i=n.getAttribute("data-type")||"W2",s=n.getAttribute("data-title")||document.title||this._getOgTitle()||"",o=n.getAttribute("data-url")||location.href,r="?title="+encodeURIComponent(s)+"&url="+encodeURIComponent(o);this._resetHashInfo(),this._hAppInfo.sAddInternalScheme=this._hAppInfo.sAddInternalScheme+r,this._hAppInfo.sAddExternalScheme=this._hAppInfo.sAddExternalScheme+r+"&version="+this._hAppInfo.nVersion,!0===this._bIsAndroid&&null!==this._hAppInfo.bUsePadding&&!1===this._hAppInfo.bUsePadding&&(this._hAppInfo.sAddExternalScheme=this._hAppInfo.sAddExternalScheme+"&usepadding=NO",this._hAppInfo.sAddInternalScheme=this._hAppInfo.sAddInternalScheme+"&usepadding=NO"),this._setButtonStyle(n,i,s),this._setButtonEvent(n,o),1==this._isAdded()&&(n.style.visibility="hidden")}},_resetHashInfo:function(){this._bIsIos?this._hAppInfo=this._hIos:this._hAppInfo=this._hAndroid},_setButtonStyle:function(e,t,n){var i=this._getButtonHtml(t,n);""!==i&&(e.innerHTML=i,this._sendLog({ver:"4",lt:"om.dp",isAvailable:this._bAvailable}))},_setButtonEvent:function(t,n){t.addEventListener?t.addEventListener("click",function(t){e._clickAddOpenMain(n),t.stopPropagation()}):t.attachEvent&&t.attachEvent("onclick",this._clickAddOpenMain(n))},_getButtonHtml:function(e,t){var n="",i=" ";switch(null!==t&&"W2"===e&&(i='<em style="padding:0 5px;font-style:normal;color:#00c73c">#'+t+"</em>"),e){case"CT":n="";break;case"T1":n='<button style="position:relative;padding:0 6px 0 25.5px;height:26px;background:transparent;border:1px solid #fff;white-space:nowrap;"><span style="position:absolute;top:0;left:0;bottom:0;z-index:10;padding:4px 5px 6px 6.5px;"><i style="display:inline-block;width:13.5px;height:14.5px;background-position:-50px 0;background-size:63.5px 42.5px;background-image: url(https://s.pstatic.net/static/www/m/2017/sp_home.png);background-repeat: no-repeat;"></i></span><span style="letter-spacing:-1px;font-size:13px;color:#fff;font-family:HelveticaNeue,AppleSDGothicNeo-Regular,Sans-serif;">메인에 추가</span></button>';break;case"W1":n='<button style="position:relative;padding:0 6px 0 25.5px;height:26px;background:#fff;border:1px solid #dcdcdc;white-space:nowrap;"><span style="position:absolute;top:0;left:0;bottom:0;z-index:10;padding:4px 5px 6px 6.5px;"><i style="display:inline-block;width:13.5px;height:14.5px;background-position:-20.5px -27px;background-size:63.5px 42.5px;background-image: url(https://s.pstatic.net/static/www/m/2017/sp_home.png);background-repeat: no-repeat;"></i></span><span style="letter-spacing:-1px;font-size:13px;color:#222;font-family:HelveticaNeue,AppleSDGothicNeo-Regular,Sans-serif;">메인에 추가</span></button>';break;default:n='<div style="display:inline-block;"><button style="position:relative;padding:0 12.5px 0 53px;height:42px;background:#fff;border:1px solid #dcdcdc;white-space:nowrap;"><span style="position:absolute;top:0;left:0;bottom:0;z-index:10;padding:6.5px 9.5px 12.5px 11px;border-right:1px solid #dcdcdc;"><i style="display:inline-block;width:20px;height:22px;background-position:0 0;background-size:63.5px 42.5px;background-image: url(https://s.pstatic.net/static/www/m/2017/sp_home.png);background-repeat: no-repeat;"></i></span><span style="display:inline-block;line-height:41px;font-size:15px;color:#222;font-family:HelveticaNeue,AppleSDGothicNeo-Regular,Sans-serif;">네이버 메인에'+i+"추가</span></button></div>"}return n},_checkEnvironment:function(){if(this._isMobile){var e=navigator.userAgent.toLowerCase();e.search("ipad")>-1?this._bIsTablet=!0:e.search("naver")>-1?this._bAvailable=!0:((e.search("iphone")>-1||e.search("ipod")>-1)&&this._nOsVersion>=9||e.search("android")>-1)&&(this._bAvailable=!0)}},_clickAddOpenMain:function(e){if(!this._bAvailable)return this._bIsTablet?(alert("오픈메인 기능을 지원하지 않는 환경입니다."),void this._sendLog({ver:"4",lt:"om.spt",sptt:"na"})):(alert("모바일 전용 기능입니다. 모바일 네이버앱에서 다시 만나요!"),void this._sendLog({ver:"4",lt:"om.spt",sptt:"tablet",env:"tablet"}));if(this._isDomainAvailable(e)){var t=navigator.userAgent.toLowerCase();if(t.search("naver")>-1){if(this._checkServiceCode())try{location.href=this._hAppInfo.sAddInternalScheme}catch(e){this._sendLog({ver:"4",lt:"om.er",ert:"isch",error:e})}else if(confirm("현재 버전에서는 지원되지 않는 기능입니다. 업데이트 하시겠습니까?"))try{location.href=this._hAppInfo.sAppStoreUrl}catch(e){this._sendLog({ver:"4",lt:"om.er",ert:"mk",error:e})}}else if((t.search("iphone")>-1||t.search("ipod")>-1)&&this._nOsVersion>=9){if(confirm("네이버앱 전용기능입니다.\n앱을 열어 네이버 메인에 추가하시겠습니까?"))if(t.search("safari")>-1)try{location.href="http://naverapp.m.naver.com/?urlScheme="+encodeURIComponent(this._hAppInfo.sAddExternalScheme)}catch(e){this._sendLog({ver:"4",lt:"om.er",ert:"osch",error:e})}else setTimeout(function(){try{location.href=this._hAppInfo.sAddExternalScheme}catch(e){this._sendLog({ver:"4",lt:"om.er",ert:"osch",error:e})}},0),setTimeout(function(){try{location.href=this._hAppInfo.sAppStoreUrl}catch(e){this._sendLog({ver:"4",lt:"om.er",ert:"mk",error:e})}},300)}else if(t.search("android")>-1&&this._nOsVersion>=4){if(confirm("네이버앱 전용기능입니다.\n앱을 열어 네이버 메인에 추가하시겠습니까?"))try{location.href=this._hAppInfo.sAddExternalScheme+"#Intent;scheme=naversearchapp;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=com.nhn.android.search;end"}catch(e){this._sendLog({ver:"4",lt:"om.er",ert:"osch",error:e})}}else alert("죄송합니다. 지원하지 않는 환경으로 네이버 메인에 이 페이지를 추가할 수 없습니다.")}else alert("의심스러운 동작이 감지돼 서비스 이용이 제한된 페이지입니다.")},_checkServiceCode:function(){return parseInt(navigator.userAgent.replace(/^.*search\s*;\s*([0-9]{3}).*$/,"$1"))>=this._hAppInfo.nServiceCode},_setOsVersion:function(){var e=navigator.userAgent,t=/^.*iPad;[\sA-z]*OS\s*([0-9_]*).*like.*$/,n=/^.*iPod;[\sA-z]*OS\s*([0-9_]*).*like.*$/,i=/^.*iPhone;[\sA-z]*OS\s*([0-9_]*).*like.*$/,s=/^.*Android\s*([0-9\.]*).*$/;t.test(e)?(this._nOsVersion=parseInt(e.replace(t,"$1")),this._bIsAndroid=!1,this._bIsIos=!0):n.test(e)?(this._nOsVersion=parseInt(e.replace(n,"$1")),this._bIsAndroid=!1,this._bIsIos=!0):i.test(e)?(this._nOsVersion=parseInt(e.replace(i,"$1")),this._bIsAndroid=!1,this._bIsIos=!0):s.test(e)?(this._nOsVersion=parseFloat(e.replace(s,"$1")),this._bIsAndroid=!0,this._bIsIos=!1):(this._nOsVersion=-1,this._bIsAndroid=!1,this._bIsIos=!1)},_isMobile:function(){return!!/iphone|ipad|ipod|android/i.test(navigator.userAgent.toLowerCase())},_isDomainAvailable:function(e){return!(e.indexOf(location.host)<0)||(this._sendLog({ver:"4",lt:"om.er",ert:"dm",cpl:location.href,ohl:e}),!1)},_sendLog:function(e){var t=new Image;t.src="https://l.msdl.naver.com/lab"+this._parseObjectToParameterString(e),t.onload=function(){t.onload=null}},_parseObjectToParameterString:function(e){var t=Object.keys(e).length,n="?",i=0;for(data in e)n+=data+"="+e[data],i<t-1&&(n+="&"),i++;return n},_getOgTitle:function(){for(var e=document.getElementsByTagName("meta"),t=0;t<e.length;t++)if("og:title"==e[t].getAttribute("property"))return e[t].getAttribute("content")},_isAdded:function(){return location.href.indexOf("napp=mysection")>-1}};e.init();