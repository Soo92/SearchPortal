/**
 * @class MoveNavigator
 * @author E-juhee
 * @date 14. 4. 30
 * @description
 */

MovingButton =  jindo.$Class({
    _GAP_BETWEEN_THE_TOP : 400,

    $init : function(elWrap, htOption) {
        this._elWrap = elWrap || document;

        // 기본 옵션 설정
        this.option({
            sClassNameOfPreviousButton : "pre_button",
            sClassNameOfNextButton : "nxt_button"
        });
        this.option(htOption || {});

        this._assignHTMLElements();
        this._initDefaultValue();
        this._setPositionOfButton();
        this._bindEvent();
        this._showButton();
    },

    _assignHTMLElements : function() {
        this._welWrap = jindo.$Element(this._elWrap);
        this._welPreviousButton = jindo.$Element(jindo.$$.getSingle("." + this.option("sClassNameOfPreviousButton"), this._elWrap));
        this._welNextButton = jindo.$Element(jindo.$$.getSingle("." + this.option("sClassNameOfNextButton"), this._elWrap));
    },

    _initDefaultValue : function() {
        this._nScreenSize = parseInt(jindo.$Document().clientSize().height,10);
        this._nWrapHeight = parseInt(this._welWrap.height(),10);
        this._nWrapTopPos = this._welWrap.offset().top;
        this._nPreviousButtonHeight = parseInt(this._welPreviousButton.height(),10);
        this._nMaxPosition = this._nWrapHeight - this._nPreviousButtonHeight;
    },

    _setPositionOfButton : function() {
        var nScrollTopPosition = jindo.$Document().scrollPosition().top;
        var nTopPos = this._GAP_BETWEEN_THE_TOP - (this._nWrapTopPos - nScrollTopPosition);

        if(this._nMaxPosition >= nTopPos) {
            this._welPreviousButton.css("top", nTopPos);
            this._welNextButton.css("top", nTopPos);
        } else {
            this._welPreviousButton.css("top", this._nMaxPosition);
            this._welNextButton.css("top", this._nMaxPosition);
        }
    },

    _bindEvent : function() {
        var oSelf = this;

        window.onscroll = function(event) {
            oSelf._onScroll();
        };

        window.onresize = function(event) {
            oSelf._onResize();
        };
    },

    _showButton : function() {
        this._welPreviousButton.show();
        this._welNextButton.show();
    },

    _moveButton : function() {
        this._setPositionOfButton();
    },

    _onScroll : function() {
        this._moveButton();
    },

    _onResize : function() {
        this._initDefaultValue();
        this._setPositionOfButton();
    }

}).extend(jindo.Component);